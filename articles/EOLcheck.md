---
title: "ライブラリの更新が止まっていることを検知させるために取ったアプローチ" # 記事のタイトル
emoji: "☺️" # アイキャッチとして使われる絵文字（1文字だけ）
type: "idea" # tech: 技術記事 / idea: アイデア記事
topics: ["gralde","GitLab"] # タグ。["markdown", "rust", "aws"]のように指定する
published: false # 公開設定（falseにすると下書き）
---
ここから本文を書く

## はじめに

どうもk1mu21です

今回はライブラリの更新が止まっていることを検知するために取っているアプローチ方法をご紹介したいと思います

ライブラリ更新でDependaBot使ってたりするとは思いますが、ライブラリ更新がずっと来ていないことの検知する機能などはないので色々試行錯誤されている方は多いと思います

一例としてこんなやり方もあるよーくらいのレベル感なので参考にしていただけると幸いです

## 読んでいただきたい方

- ライブラリのEOLへの対処を考えている方

## 　まず検知するためにツールを導入しようとした

ツールとしてyamoryというものがあるので調べてみましたが、有償で資料請求などしないと詳細がわからないなどで部単位で検討しないといけなくなると思い除外しました

https://yamory.io

他にxeolというものもあり無償で使えて良さそうでしたが、今はこんなにきっちりしたもの導入するフェーズか？もっと簡単なものをサクッと導入して効果を見た方がいいかも？と思いもう少し考え直すことにしました

ちなみにxeolを使えば、SBOMやコンテナイメージ、ディレクトリをスキャンすることで使用しているソフトウェアのバージョンがEOLであるかを検知できます

後はxeol DBを配置してー、コンテナイメージやSBOMを生成してー、スキャンしてーなどをする必要があり、別にここまで現状はいらないなーと思ったのもあります

https://github.com/xeol-io/xeol

## 結果ツールを導入する必要すらあるか？と考え直した

別に簡単に入れて効果見たいだけなら自分でソレっぽいものを作れば良くないか？と思い色々調査しました

その結果librariesを使えばソレっぽいの作れそうということが分かったので早速設計に取り掛かりました

https://libraries.io/

```massage
librariesはSonerCloudなどを提供しているTIDELIFT社のサービスになります
```

librariesのAPIドキュメントを見るとGETで以下の形式のURLを叩くとそのライブラリの状況が取得できるということが調査でわかりました

```
https://libraries.io/api/プラットフォーム名/パッケージ名?api_key=API_KEY
```

https://libraries.io/api

そこで以下の方針で進めればいけるんじゃないか〜！！！というところまで定まりました

1. リポジトリの使っているライブラリをどうにかして取得する
2. 取得したライブラリ情報をもとにlibrariesのAPIを叩き、ライブラリの情報を取得する
3. CIを回して対象ライブラリが最終更新からxヶ月立ってれば更新止まっていないか確認しろよー的な感じでIssueを作る


## 早速実装に取り掛かる

```massage
今後の例はJava+Gradle+GitLab-ciをメインに進めていきます
```

今回はgradleを使っているので利用しているライブラリを吐き出せるコマンドがあり、その出力結果をtxtファイルに出力して１は達成できました

```
